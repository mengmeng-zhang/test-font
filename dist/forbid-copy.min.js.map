{"version":3,"sources":["webpack://createCopyListener/webpack/universalModuleDefinition","webpack://createCopyListener/webpack/bootstrap","webpack://createCopyListener/./node_modules/@babel/runtime/helpers/arrayLikeToArray.js","webpack://createCopyListener/./node_modules/@babel/runtime/helpers/arrayWithHoles.js","webpack://createCopyListener/./node_modules/@babel/runtime/helpers/arrayWithoutHoles.js","webpack://createCopyListener/./node_modules/@babel/runtime/helpers/classCallCheck.js","webpack://createCopyListener/./node_modules/@babel/runtime/helpers/classPrivateFieldGet.js","webpack://createCopyListener/./node_modules/@babel/runtime/helpers/classPrivateFieldSet.js","webpack://createCopyListener/./node_modules/@babel/runtime/helpers/createClass.js","webpack://createCopyListener/./node_modules/@babel/runtime/helpers/interopRequireDefault.js","webpack://createCopyListener/./node_modules/@babel/runtime/helpers/iterableToArray.js","webpack://createCopyListener/./node_modules/@babel/runtime/helpers/iterableToArrayLimit.js","webpack://createCopyListener/./node_modules/@babel/runtime/helpers/nonIterableRest.js","webpack://createCopyListener/./node_modules/@babel/runtime/helpers/nonIterableSpread.js","webpack://createCopyListener/./node_modules/@babel/runtime/helpers/slicedToArray.js","webpack://createCopyListener/./node_modules/@babel/runtime/helpers/toConsumableArray.js","webpack://createCopyListener/./node_modules/@babel/runtime/helpers/unsupportedIterableToArray.js","webpack://createCopyListener/./node_modules/charenc/charenc.js","webpack://createCopyListener/./node_modules/crypt/crypt.js","webpack://createCopyListener/./node_modules/is-buffer/index.js","webpack://createCopyListener/./node_modules/md5/md5.js","webpack://createCopyListener/./src/config/index.js","webpack://createCopyListener/./src/config/option.js","webpack://createCopyListener/./src/core/copyListener.js","webpack://createCopyListener/./src/core/deviceDetect.js","webpack://createCopyListener/./src/core/fontManager.js","webpack://createCopyListener/./src/core/recorder.js","webpack://createCopyListener/./src/core/transfer.js","webpack://createCopyListener/./src/data/events.js","webpack://createCopyListener/./src/data/fonts.js","webpack://createCopyListener/./src/data/index.js","webpack://createCopyListener/./src/index.js","webpack://createCopyListener/./src/utils/index.js"],"names":["config","GATHER_SERVER_URL","G_GATHER_SERVER_URL","API_KEY","G_API_KEY","ERROR_GATHER_SERVER_URL","G_ERROR_GATHER_SERVER_URL","ERROR_API_KEY","G_ERROR_API_KEY","VERSION","G_VERSION","CHUNKCOUNT","G_CHUNKCOUNT","CODE_BASE","G_CODE_BASE","CODELEN","G_CODE_LEN","FONT_BASE_URL","G_FONT_BASE_URL","SPADES_URL","G_SPADES_URL","IS_SERVER_TRANSFER","G_IS_SERVER_TRANSFER","FONT_TYPES","G_FONT_TYPES","TIMEOUT","G_TIMEOUT","VALID_SYSTEM","G_SYSTEM","IS_OPEN_NON_NETWORK","G_OPEN_NON_NETWORK","module","exports","DeviceDetect","require","Utils","MICROSOFTYAHEI","PINGFANGSC","defaultOptions","fontName","winFontName","macFontName","androidFontName","iosFontName","timeout","OptionsManager","options","isObject","system","getSystem","toUpperCase","checkOptions","systemFontName","paramName","type","isNotString","isNotNaNNumber","Transfer","EVENT_CONNECTED","EVENT_TIMEOUT","EVENT_ADD_FONT_RULE","EVENT_REMOVE","EVENT_ERROR","CopyListener","recorder","fontManager","eventQueue","domSelector","Set","promises","isServerTransfer","push","loadSpadeFile","loadAllFontFile","Promise","all","then","encodeText","fontUrls","addFontSpade","document","body","buildFontDeclareStyle","addEventListener","console","log","abbrGlyphCode","record","catch","errType","update","err","on","text","warn","timeStep","waitTime","resolve","reject","timer","setInterval","clearInterval","_trigger","manager","getTimeout","selector","oldLength","size","add","getAllFontNames","indexOf","addFontDeclare","eventName","addFontSelector","isValidSystem","transform","local","callback","eventParams","defaultHandler","length","i","handler","Array","isArray","isPCEnvironment","getPCSystem","getMobileSystem","window","navigator","userAgent","exec","platform","toLowerCase","match","deviceInfo","os","getPCBrowserInfo","browser","browserVersion","version","Object","assign","isPC","isLowIE","getMobileBrowserInfo","osVersion","networkType","data","IERegExp","RegExp","EdgeRegExp","parseInt","key","mimeTypes","replace","connection","effectiveType","HTMLTAGS","FontManager","getSystemFontName","fontSets","fontUrl","loaded","xhr","XMLHttpRequest","open","setRequestHeader","onreadystatechange","readyState","DONE","status","responseText","ontimeout","onerror","send","index","findIndex","font","fonts","FontFace","fontPromises","map","fontType","load","loadFontFile","error","spades","JSON","parse","charCode","String","fromCharCode","style","createElement","id","fontFormat","fontFamilySrc","forEach","fontDeclare","oldFontFamily","getComputedStyle","fontFamily","newFontFamily","innerHTML","head","appendChild","ruleName","styleTAG","getElementById","oldStyleRules","textContent","removeChild","styleRules","fontNames","md5","STORAGE_ITEM_KEY","STORAGE_PREFIX","STORAGE_CHAR_COUNT","STORAGE_TRANS_COUNT","EVENT_SUCCESS","Recorder","oaCount","appKey","glyphCode","devCustomGlyphCode","lastCreatedTime","Date","now","generateCustomGlyphCode","source","abbrcode","slice","split","unit","codeStr","Number","toString","Math","sqrt","join","month","getMonth","day","getDate","time","customCode","code","num","getDeviceInfo","prevWMData","localStorage","itemKey","concat","getItem","wmItem","wmKey","userAccount","markTime","extendValue","stringify","title","location","href","res","response","clearWaterMarkStorage","saveWaterMarkStorage","transCount","charCount","oldCharCount","oldTransCount","isNaN","setItem","mode","customGlyphCode","removeItem","generateGlyphCode","processText","textObj","execRes","splitHtml","splitIndex","presplitIndex","cjkCharReg","r","test","part","char","glyphIndex","charUnicode","j","charCodeAt","recordGlyphCount","generateLocalGlyphCode","recordError","createCopyListener","listener","setMode","optionsManager","newFontName","obj","prototype","call","isNotEmptyString","str"],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD,O;QCVA;QACA;;QAEA;QACA;;QAEA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;;QAEA;QACA;;QAEA;QACA;;QAEA;QACA;QACA;;;QAGA;QACA;;QAEA;QACA;;QAEA;QACA;QACA;QACA,0CAA0C,gCAAgC;QAC1E;QACA;;QAEA;QACA;QACA;QACA,wDAAwD,kBAAkB;QAC1E;QACA,iDAAiD,cAAc;QAC/D;;QAEA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA,yCAAyC,iCAAiC;QAC1E,gHAAgH,mBAAmB,EAAE;QACrI;QACA;;QAEA;QACA;QACA;QACA,2BAA2B,0BAA0B,EAAE;QACvD,iCAAiC,eAAe;QAChD;QACA;QACA;;QAEA;QACA,sDAAsD,+DAA+D;;QAErH;QACA;;;QAGA;QACA;;;;;;;;;;;;AClFA;AACA;;AAEA,wCAAwC,SAAS;AACjD;AACA;;AAEA;AACA;;AAEA,mC;;;;;;;;;;;ACVA;AACA;AACA;;AAEA,iC;;;;;;;;;;;ACJA,uBAAuB,mBAAO,CAAC,qFAAoB;;AAEnD;AACA;AACA;;AAEA,oC;;;;;;;;;;;ACNA;AACA;AACA;AACA;AACA;;AAEA,iC;;;;;;;;;;;ACNA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA,uC;;;;;;;;;;;ACdA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,GAAG;AACH;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA,uC;;;;;;;;;;;ACpBA;AACA,iBAAiB,kBAAkB;AACnC;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA,8B;;;;;;;;;;;AChBA;AACA;AACA;AACA;AACA;;AAEA,wC;;;;;;;;;;;ACNA;AACA;AACA;;AAEA,kC;;;;;;;;;;;ACJA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,6CAA6C,+BAA+B;AAC5E;;AAEA;AACA;AACA,GAAG;AACH;AACA;AACA,GAAG;AACH;AACA;AACA,KAAK;AACL;AACA;AACA;;AAEA;AACA;;AAEA,uC;;;;;;;;;;;AC3BA;AACA;AACA;;AAEA,kC;;;;;;;;;;;ACJA;AACA;AACA;;AAEA,oC;;;;;;;;;;;ACJA,qBAAqB,mBAAO,CAAC,iFAAkB;;AAE/C,2BAA2B,mBAAO,CAAC,6FAAwB;;AAE3D,iCAAiC,mBAAO,CAAC,yGAA8B;;AAEvE,sBAAsB,mBAAO,CAAC,mFAAmB;;AAEjD;AACA;AACA;;AAEA,gC;;;;;;;;;;;ACZA,wBAAwB,mBAAO,CAAC,uFAAqB;;AAErD,sBAAsB,mBAAO,CAAC,mFAAmB;;AAEjD,iCAAiC,mBAAO,CAAC,yGAA8B;;AAEvE,wBAAwB,mBAAO,CAAC,uFAAqB;;AAErD;AACA;AACA;;AAEA,oC;;;;;;;;;;;ACZA,uBAAuB,mBAAO,CAAC,qFAAoB;;AAEnD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,6C;;;;;;;;;;;ACXA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA,GAAG;;AAEH;AACA;AACA;AACA;AACA,iCAAiC,gBAAgB;AACjD;AACA;AACA,KAAK;;AAEL;AACA;AACA,+BAA+B,kBAAkB;AACjD;AACA;AACA;AACA;AACA;;AAEA;;;;;;;;;;;;AChCA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,qBAAqB,cAAc;AACnC;AACA;AACA,KAAK;;AAEL;AACA;AACA,0BAA0B,OAAO;AACjC;AACA;AACA,KAAK;;AAEL;AACA;AACA,wCAAwC,kBAAkB;AAC1D;AACA;AACA,KAAK;;AAEL;AACA;AACA,iCAAiC,uBAAuB;AACxD;AACA;AACA,KAAK;;AAEL;AACA;AACA,+BAA+B,kBAAkB;AACjD;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA,iCAAiC,gBAAgB;AACjD;AACA;AACA,KAAK;;AAEL;AACA;AACA,kCAAkC,kBAAkB;AACpD;AACA,uBAAuB,OAAO;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;;AAEA,4CAA4C;AAC5C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,CAAC;;;;;;;;;;;;AC/FD;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;;;;;;;;;;;ACpBA;AACA,cAAc,mBAAO,CAAC,4CAAO;AAC7B,aAAa,mBAAO,CAAC,kDAAS;AAC9B,iBAAiB,mBAAO,CAAC,oDAAW;AACpC,YAAY,mBAAO,CAAC,kDAAS;;AAE7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,mBAAmB,cAAc;AACjC;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA,mBAAmB,cAAc;;AAEjC;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA,CAAC;;;;;;;;;;;;;;;AC/JD;AACA,MAAMA,MAAM,GAAG;AACbC,qB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","file":"forbid-copy.dev.min.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"createCopyListener\"] = factory();\n\telse\n\t\troot[\"createCopyListener\"] = factory();\n})(window, function() {\nreturn "," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = \"./src/index.js\");\n","function _arrayLikeToArray(arr, len) {\n  if (len == null || len > arr.length) len = arr.length;\n\n  for (var i = 0, arr2 = new Array(len); i < len; i++) {\n    arr2[i] = arr[i];\n  }\n\n  return arr2;\n}\n\nmodule.exports = _arrayLikeToArray;","function _arrayWithHoles(arr) {\n  if (Array.isArray(arr)) return arr;\n}\n\nmodule.exports = _arrayWithHoles;","var arrayLikeToArray = require(\"./arrayLikeToArray\");\n\nfunction _arrayWithoutHoles(arr) {\n  if (Array.isArray(arr)) return arrayLikeToArray(arr);\n}\n\nmodule.exports = _arrayWithoutHoles;","function _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}\n\nmodule.exports = _classCallCheck;","function _classPrivateFieldGet(receiver, privateMap) {\n  var descriptor = privateMap.get(receiver);\n\n  if (!descriptor) {\n    throw new TypeError(\"attempted to get private field on non-instance\");\n  }\n\n  if (descriptor.get) {\n    return descriptor.get.call(receiver);\n  }\n\n  return descriptor.value;\n}\n\nmodule.exports = _classPrivateFieldGet;","function _classPrivateFieldSet(receiver, privateMap, value) {\n  var descriptor = privateMap.get(receiver);\n\n  if (!descriptor) {\n    throw new TypeError(\"attempted to set private field on non-instance\");\n  }\n\n  if (descriptor.set) {\n    descriptor.set.call(receiver, value);\n  } else {\n    if (!descriptor.writable) {\n      throw new TypeError(\"attempted to set read only private field\");\n    }\n\n    descriptor.value = value;\n  }\n\n  return value;\n}\n\nmodule.exports = _classPrivateFieldSet;","function _defineProperties(target, props) {\n  for (var i = 0; i < props.length; i++) {\n    var descriptor = props[i];\n    descriptor.enumerable = descriptor.enumerable || false;\n    descriptor.configurable = true;\n    if (\"value\" in descriptor) descriptor.writable = true;\n    Object.defineProperty(target, descriptor.key, descriptor);\n  }\n}\n\nfunction _createClass(Constructor, protoProps, staticProps) {\n  if (protoProps) _defineProperties(Constructor.prototype, protoProps);\n  if (staticProps) _defineProperties(Constructor, staticProps);\n  return Constructor;\n}\n\nmodule.exports = _createClass;","function _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    \"default\": obj\n  };\n}\n\nmodule.exports = _interopRequireDefault;","function _iterableToArray(iter) {\n  if (typeof Symbol !== \"undefined\" && Symbol.iterator in Object(iter)) return Array.from(iter);\n}\n\nmodule.exports = _iterableToArray;","function _iterableToArrayLimit(arr, i) {\n  if (typeof Symbol === \"undefined\" || !(Symbol.iterator in Object(arr))) return;\n  var _arr = [];\n  var _n = true;\n  var _d = false;\n  var _e = undefined;\n\n  try {\n    for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) {\n      _arr.push(_s.value);\n\n      if (i && _arr.length === i) break;\n    }\n  } catch (err) {\n    _d = true;\n    _e = err;\n  } finally {\n    try {\n      if (!_n && _i[\"return\"] != null) _i[\"return\"]();\n    } finally {\n      if (_d) throw _e;\n    }\n  }\n\n  return _arr;\n}\n\nmodule.exports = _iterableToArrayLimit;","function _nonIterableRest() {\n  throw new TypeError(\"Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n}\n\nmodule.exports = _nonIterableRest;","function _nonIterableSpread() {\n  throw new TypeError(\"Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n}\n\nmodule.exports = _nonIterableSpread;","var arrayWithHoles = require(\"./arrayWithHoles\");\n\nvar iterableToArrayLimit = require(\"./iterableToArrayLimit\");\n\nvar unsupportedIterableToArray = require(\"./unsupportedIterableToArray\");\n\nvar nonIterableRest = require(\"./nonIterableRest\");\n\nfunction _slicedToArray(arr, i) {\n  return arrayWithHoles(arr) || iterableToArrayLimit(arr, i) || unsupportedIterableToArray(arr, i) || nonIterableRest();\n}\n\nmodule.exports = _slicedToArray;","var arrayWithoutHoles = require(\"./arrayWithoutHoles\");\n\nvar iterableToArray = require(\"./iterableToArray\");\n\nvar unsupportedIterableToArray = require(\"./unsupportedIterableToArray\");\n\nvar nonIterableSpread = require(\"./nonIterableSpread\");\n\nfunction _toConsumableArray(arr) {\n  return arrayWithoutHoles(arr) || iterableToArray(arr) || unsupportedIterableToArray(arr) || nonIterableSpread();\n}\n\nmodule.exports = _toConsumableArray;","var arrayLikeToArray = require(\"./arrayLikeToArray\");\n\nfunction _unsupportedIterableToArray(o, minLen) {\n  if (!o) return;\n  if (typeof o === \"string\") return arrayLikeToArray(o, minLen);\n  var n = Object.prototype.toString.call(o).slice(8, -1);\n  if (n === \"Object\" && o.constructor) n = o.constructor.name;\n  if (n === \"Map\" || n === \"Set\") return Array.from(o);\n  if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return arrayLikeToArray(o, minLen);\n}\n\nmodule.exports = _unsupportedIterableToArray;","var charenc = {\n  // UTF-8 encoding\n  utf8: {\n    // Convert a string to a byte array\n    stringToBytes: function(str) {\n      return charenc.bin.stringToBytes(unescape(encodeURIComponent(str)));\n    },\n\n    // Convert a byte array to a string\n    bytesToString: function(bytes) {\n      return decodeURIComponent(escape(charenc.bin.bytesToString(bytes)));\n    }\n  },\n\n  // Binary encoding\n  bin: {\n    // Convert a string to a byte array\n    stringToBytes: function(str) {\n      for (var bytes = [], i = 0; i < str.length; i++)\n        bytes.push(str.charCodeAt(i) & 0xFF);\n      return bytes;\n    },\n\n    // Convert a byte array to a string\n    bytesToString: function(bytes) {\n      for (var str = [], i = 0; i < bytes.length; i++)\n        str.push(String.fromCharCode(bytes[i]));\n      return str.join('');\n    }\n  }\n};\n\nmodule.exports = charenc;\n","(function() {\n  var base64map\n      = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/',\n\n  crypt = {\n    // Bit-wise rotation left\n    rotl: function(n, b) {\n      return (n << b) | (n >>> (32 - b));\n    },\n\n    // Bit-wise rotation right\n    rotr: function(n, b) {\n      return (n << (32 - b)) | (n >>> b);\n    },\n\n    // Swap big-endian to little-endian and vice versa\n    endian: function(n) {\n      // If number given, swap endian\n      if (n.constructor == Number) {\n        return crypt.rotl(n, 8) & 0x00FF00FF | crypt.rotl(n, 24) & 0xFF00FF00;\n      }\n\n      // Else, assume array and swap all items\n      for (var i = 0; i < n.length; i++)\n        n[i] = crypt.endian(n[i]);\n      return n;\n    },\n\n    // Generate an array of any length of random bytes\n    randomBytes: function(n) {\n      for (var bytes = []; n > 0; n--)\n        bytes.push(Math.floor(Math.random() * 256));\n      return bytes;\n    },\n\n    // Convert a byte array to big-endian 32-bit words\n    bytesToWords: function(bytes) {\n      for (var words = [], i = 0, b = 0; i < bytes.length; i++, b += 8)\n        words[b >>> 5] |= bytes[i] << (24 - b % 32);\n      return words;\n    },\n\n    // Convert big-endian 32-bit words to a byte array\n    wordsToBytes: function(words) {\n      for (var bytes = [], b = 0; b < words.length * 32; b += 8)\n        bytes.push((words[b >>> 5] >>> (24 - b % 32)) & 0xFF);\n      return bytes;\n    },\n\n    // Convert a byte array to a hex string\n    bytesToHex: function(bytes) {\n      for (var hex = [], i = 0; i < bytes.length; i++) {\n        hex.push((bytes[i] >>> 4).toString(16));\n        hex.push((bytes[i] & 0xF).toString(16));\n      }\n      return hex.join('');\n    },\n\n    // Convert a hex string to a byte array\n    hexToBytes: function(hex) {\n      for (var bytes = [], c = 0; c < hex.length; c += 2)\n        bytes.push(parseInt(hex.substr(c, 2), 16));\n      return bytes;\n    },\n\n    // Convert a byte array to a base-64 string\n    bytesToBase64: function(bytes) {\n      for (var base64 = [], i = 0; i < bytes.length; i += 3) {\n        var triplet = (bytes[i] << 16) | (bytes[i + 1] << 8) | bytes[i + 2];\n        for (var j = 0; j < 4; j++)\n          if (i * 8 + j * 6 <= bytes.length * 8)\n            base64.push(base64map.charAt((triplet >>> 6 * (3 - j)) & 0x3F));\n          else\n            base64.push('=');\n      }\n      return base64.join('');\n    },\n\n    // Convert a base-64 string to a byte array\n    base64ToBytes: function(base64) {\n      // Remove non-base-64 characters\n      base64 = base64.replace(/[^A-Z0-9+\\/]/ig, '');\n\n      for (var bytes = [], i = 0, imod4 = 0; i < base64.length;\n          imod4 = ++i % 4) {\n        if (imod4 == 0) continue;\n        bytes.push(((base64map.indexOf(base64.charAt(i - 1))\n            & (Math.pow(2, -2 * imod4 + 8) - 1)) << (imod4 * 2))\n            | (base64map.indexOf(base64.charAt(i)) >>> (6 - imod4 * 2)));\n      }\n      return bytes;\n    }\n  };\n\n  module.exports = crypt;\n})();\n","/*!\n * Determine if an object is a Buffer\n *\n * @author   Feross Aboukhadijeh <https://feross.org>\n * @license  MIT\n */\n\n// The _isBuffer check is for Safari 5-7 support, because it's missing\n// Object.prototype.constructor. Remove this eventually\nmodule.exports = function (obj) {\n  return obj != null && (isBuffer(obj) || isSlowBuffer(obj) || !!obj._isBuffer)\n}\n\nfunction isBuffer (obj) {\n  return !!obj.constructor && typeof obj.constructor.isBuffer === 'function' && obj.constructor.isBuffer(obj)\n}\n\n// For Node v0.10 support. Remove this eventually.\nfunction isSlowBuffer (obj) {\n  return typeof obj.readFloatLE === 'function' && typeof obj.slice === 'function' && isBuffer(obj.slice(0, 0))\n}\n","(function(){\r\n  var crypt = require('crypt'),\r\n      utf8 = require('charenc').utf8,\r\n      isBuffer = require('is-buffer'),\r\n      bin = require('charenc').bin,\r\n\r\n  // The core\r\n  md5 = function (message, options) {\r\n    // Convert to byte array\r\n    if (message.constructor == String)\r\n      if (options && options.encoding === 'binary')\r\n        message = bin.stringToBytes(message);\r\n      else\r\n        message = utf8.stringToBytes(message);\r\n    else if (isBuffer(message))\r\n      message = Array.prototype.slice.call(message, 0);\r\n    else if (!Array.isArray(message) && message.constructor !== Uint8Array)\r\n      message = message.toString();\r\n    // else, assume byte array already\r\n\r\n    var m = crypt.bytesToWords(message),\r\n        l = message.length * 8,\r\n        a =  1732584193,\r\n        b = -271733879,\r\n        c = -1732584194,\r\n        d =  271733878;\r\n\r\n    // Swap endian\r\n    for (var i = 0; i < m.length; i++) {\r\n      m[i] = ((m[i] <<  8) | (m[i] >>> 24)) & 0x00FF00FF |\r\n             ((m[i] << 24) | (m[i] >>>  8)) & 0xFF00FF00;\r\n    }\r\n\r\n    // Padding\r\n    m[l >>> 5] |= 0x80 << (l % 32);\r\n    m[(((l + 64) >>> 9) << 4) + 14] = l;\r\n\r\n    // Method shortcuts\r\n    var FF = md5._ff,\r\n        GG = md5._gg,\r\n        HH = md5._hh,\r\n        II = md5._ii;\r\n\r\n    for (var i = 0; i < m.length; i += 16) {\r\n\r\n      var aa = a,\r\n          bb = b,\r\n          cc = c,\r\n          dd = d;\r\n\r\n      a = FF(a, b, c, d, m[i+ 0],  7, -680876936);\r\n      d = FF(d, a, b, c, m[i+ 1], 12, -389564586);\r\n      c = FF(c, d, a, b, m[i+ 2], 17,  606105819);\r\n      b = FF(b, c, d, a, m[i+ 3], 22, -1044525330);\r\n      a = FF(a, b, c, d, m[i+ 4],  7, -176418897);\r\n      d = FF(d, a, b, c, m[i+ 5], 12,  1200080426);\r\n      c = FF(c, d, a, b, m[i+ 6], 17, -1473231341);\r\n      b = FF(b, c, d, a, m[i+ 7], 22, -45705983);\r\n      a = FF(a, b, c, d, m[i+ 8],  7,  1770035416);\r\n      d = FF(d, a, b, c, m[i+ 9], 12, -1958414417);\r\n      c = FF(c, d, a, b, m[i+10], 17, -42063);\r\n      b = FF(b, c, d, a, m[i+11], 22, -1990404162);\r\n      a = FF(a, b, c, d, m[i+12],  7,  1804603682);\r\n      d = FF(d, a, b, c, m[i+13], 12, -40341101);\r\n      c = FF(c, d, a, b, m[i+14], 17, -1502002290);\r\n      b = FF(b, c, d, a, m[i+15], 22,  1236535329);\r\n\r\n      a = GG(a, b, c, d, m[i+ 1],  5, -165796510);\r\n      d = GG(d, a, b, c, m[i+ 6],  9, -1069501632);\r\n      c = GG(c, d, a, b, m[i+11], 14,  643717713);\r\n      b = GG(b, c, d, a, m[i+ 0], 20, -373897302);\r\n      a = GG(a, b, c, d, m[i+ 5],  5, -701558691);\r\n      d = GG(d, a, b, c, m[i+10],  9,  38016083);\r\n      c = GG(c, d, a, b, m[i+15], 14, -660478335);\r\n      b = GG(b, c, d, a, m[i+ 4], 20, -405537848);\r\n      a = GG(a, b, c, d, m[i+ 9],  5,  568446438);\r\n      d = GG(d, a, b, c, m[i+14],  9, -1019803690);\r\n      c = GG(c, d, a, b, m[i+ 3], 14, -187363961);\r\n      b = GG(b, c, d, a, m[i+ 8], 20,  1163531501);\r\n      a = GG(a, b, c, d, m[i+13],  5, -1444681467);\r\n      d = GG(d, a, b, c, m[i+ 2],  9, -51403784);\r\n      c = GG(c, d, a, b, m[i+ 7], 14,  1735328473);\r\n      b = GG(b, c, d, a, m[i+12], 20, -1926607734);\r\n\r\n      a = HH(a, b, c, d, m[i+ 5],  4, -378558);\r\n      d = HH(d, a, b, c, m[i+ 8], 11, -2022574463);\r\n      c = HH(c, d, a, b, m[i+11], 16,  1839030562);\r\n      b = HH(b, c, d, a, m[i+14], 23, -35309556);\r\n      a = HH(a, b, c, d, m[i+ 1],  4, -1530992060);\r\n      d = HH(d, a, b, c, m[i+ 4], 11,  1272893353);\r\n      c = HH(c, d, a, b, m[i+ 7], 16, -155497632);\r\n      b = HH(b, c, d, a, m[i+10], 23, -1094730640);\r\n      a = HH(a, b, c, d, m[i+13],  4,  681279174);\r\n      d = HH(d, a, b, c, m[i+ 0], 11, -358537222);\r\n      c = HH(c, d, a, b, m[i+ 3], 16, -722521979);\r\n      b = HH(b, c, d, a, m[i+ 6], 23,  76029189);\r\n      a = HH(a, b, c, d, m[i+ 9],  4, -640364487);\r\n      d = HH(d, a, b, c, m[i+12], 11, -421815835);\r\n      c = HH(c, d, a, b, m[i+15], 16,  530742520);\r\n      b = HH(b, c, d, a, m[i+ 2], 23, -995338651);\r\n\r\n      a = II(a, b, c, d, m[i+ 0],  6, -198630844);\r\n      d = II(d, a, b, c, m[i+ 7], 10,  1126891415);\r\n      c = II(c, d, a, b, m[i+14], 15, -1416354905);\r\n      b = II(b, c, d, a, m[i+ 5], 21, -57434055);\r\n      a = II(a, b, c, d, m[i+12],  6,  1700485571);\r\n      d = II(d, a, b, c, m[i+ 3], 10, -1894986606);\r\n      c = II(c, d, a, b, m[i+10], 15, -1051523);\r\n      b = II(b, c, d, a, m[i+ 1], 21, -2054922799);\r\n      a = II(a, b, c, d, m[i+ 8],  6,  1873313359);\r\n      d = II(d, a, b, c, m[i+15], 10, -30611744);\r\n      c = II(c, d, a, b, m[i+ 6], 15, -1560198380);\r\n      b = II(b, c, d, a, m[i+13], 21,  1309151649);\r\n      a = II(a, b, c, d, m[i+ 4],  6, -145523070);\r\n      d = II(d, a, b, c, m[i+11], 10, -1120210379);\r\n      c = II(c, d, a, b, m[i+ 2], 15,  718787259);\r\n      b = II(b, c, d, a, m[i+ 9], 21, -343485551);\r\n\r\n      a = (a + aa) >>> 0;\r\n      b = (b + bb) >>> 0;\r\n      c = (c + cc) >>> 0;\r\n      d = (d + dd) >>> 0;\r\n    }\r\n\r\n    return crypt.endian([a, b, c, d]);\r\n  };\r\n\r\n  // Auxiliary functions\r\n  md5._ff  = function (a, b, c, d, x, s, t) {\r\n    var n = a + (b & c | ~b & d) + (x >>> 0) + t;\r\n    return ((n << s) | (n >>> (32 - s))) + b;\r\n  };\r\n  md5._gg  = function (a, b, c, d, x, s, t) {\r\n    var n = a + (b & d | c & ~d) + (x >>> 0) + t;\r\n    return ((n << s) | (n >>> (32 - s))) + b;\r\n  };\r\n  md5._hh  = function (a, b, c, d, x, s, t) {\r\n    var n = a + (b ^ c ^ d) + (x >>> 0) + t;\r\n    return ((n << s) | (n >>> (32 - s))) + b;\r\n  };\r\n  md5._ii  = function (a, b, c, d, x, s, t) {\r\n    var n = a + (c ^ (b | ~d)) + (x >>> 0) + t;\r\n    return ((n << s) | (n >>> (32 - s))) + b;\r\n  };\r\n\r\n  // Package private blocksize\r\n  md5._blocksize = 16;\r\n  md5._digestsize = 16;\r\n\r\n  module.exports = function (message, options) {\r\n    if (message === undefined || message === null)\r\n      throw new Error('Illegal argument ' + message);\r\n\r\n    var digestbytes = crypt.wordsToBytes(md5(message, options));\r\n    return options && options.asBytes ? digestbytes :\r\n        options && options.asString ? bin.bytesToString(digestbytes) :\r\n        crypt.bytesToHex(digestbytes);\r\n  };\r\n\r\n})();\r\n","// 配置文件\nconst config = {\n  GATHER_SERVER_URL: G_GATHER_SERVER_URL,\n  API_KEY: G_API_KEY,\n  ERROR_GATHER_SERVER_URL: G_ERROR_GATHER_SERVER_URL,\n  ERROR_API_KEY: G_ERROR_API_KEY,\n  VERSION: G_VERSION, // SDK版本号\n  CHUNKCOUNT: G_CHUNKCOUNT, // 水印编码转换字数统计上报阈值\n  CODE_BASE: G_CODE_BASE, // 水印编码转换进制\n  CODELEN: G_CODE_LEN, // 水印编码长度10\n  // FONT_BASE_URL: G_FONT_BASE_URL + G_VERSION + '/', // 字体文件路径\n  FONT_BASE_URL: G_FONT_BASE_URL, // 字体文件路径\n  SPADES_URL: G_SPADES_URL, // 字符表\n  IS_SERVER_TRANSFER: G_IS_SERVER_TRANSFER, // 服务端转换文本\n  FONT_TYPES: G_FONT_TYPES, // 字体文件支持类型\n  TIMEOUT: G_TIMEOUT, // 资源加载超时时间\n  VALID_SYSTEM: G_SYSTEM, // 开启字体水印的操作系统\n  IS_OPEN_NON_NETWORK: G_OPEN_NON_NETWORK // 开始无网络状态水印处理\n}\n\nmodule.exports = config","const DeviceDetect = require(\"../core/deviceDetect\")\nconst Utils = require(\"../utils\")\nconst { MICROSOFTYAHEI, PINGFANGSC } = require(\"../data/fonts\")\n\nconst defaultOptions = {\n  fontName: '',\n  winFontName: '',\n  macFontName: '',\n  androidFontName: '',\n  iosFontName: '',\n  timeout: 3000\n}\n\n/**\n *    fontName: 全部操作系统默认字体(MicrosoftYahei) // 其实没有默认值\n *    winFontName: windows(MicrosoftYahei)\n *    macFontName: mac(PingfangSC)\n *    androidFontName: android(MicrosoftYahei)\n *    iosFontName: ios(PingfangSC)\n *    timeout: 超时时间\n * 不建议开放的配置\n *    system: 指定开启水印编码的操作系统(window/mac/android/ios)\n */\nclass OptionsManager {\n  constructor(options) {\n    if (!Utils.isObject(options)) {\n      options = {}\n    }\n    var system = DeviceDetect.getSystem().toUpperCase() || 'WINDOWS' // WINDOWS MAC IOS ANDROID\n    // 处理fontName得到当前系统指定的字体名称\n    checkOptions(options, 'fontName', 'string')\n    checkOptions(options, 'winFontName', 'string')\n    checkOptions(options, 'macFontName', 'string')\n    checkOptions(options, 'androidFontName', 'string')\n    checkOptions(options, 'iosFontName', 'string')\n    options['WINDOWS'] = options['winFontName'] || options['fontName'] || MICROSOFTYAHEI\n    options['MAC'] = options['macFontName'] || options['fontName'] || PINGFANGSC\n    options['ANDROID'] = options['androidFontName'] || options['fontName'] || MICROSOFTYAHEI\n    options['IOS'] = options['iosFontName'] || options['fontName'] || PINGFANGSC\n    this.options = options\n    this.systemFontName = this.options[system]\n  }\n\n  getSystemFontName() {\n    return this.systemFontName\n  }\n\n  getTimeout() {\n    return this.options['timeout']\n  }\n}\n\nfunction checkOptions(options, paramName, type) {\n  switch (type) {\n    case 'string':\n      if (options[paramName] && Utils.isNotString(options[paramName])) {\n        options[paramName] = defaultOptions[paramName]\n      }\n      break;\n    case 'number':\n      if (options[paramName] && Utils.isNotNaNNumber(options[paramName])) {\n        options[paramName] = defaultOptions[paramName]\n      }\n      break;\n    default:\n      break;\n  }\n}\n\nmodule.exports = OptionsManager\n","const Transfer = require('./transfer')\nconst Utils = require('../utils/index')\nconst config = require('../config')\nconst { EVENT_CONNECTED, EVENT_TIMEOUT, EVENT_ADD_FONT_RULE, EVENT_REMOVE, EVENT_ERROR } = require('../data/events')\nconst DeviceDetect = require('./deviceDetect')\n\nclass CopyListener {\n  #transfer = null\n  #loaded = false\n  #error = false\n  #recorder = null\n  #fontManager = null\n  constructor(recorder, fontManager) {\n    this.#recorder = recorder\n    this.#fontManager = fontManager // 字体资源管理器\n    this.eventQueue = {} // 事件队列\n    this.domSelector = new Set()\n    var promises = []\n    if (!DeviceDetect.isServerTransfer()) {\n      promises.push(this.#fontManager.loadSpadeFile()) // 加载字形unicode文件\n    }\n    promises.push(this.#fontManager.loadAllFontFile()) // 加载字体文件\n    Promise.all(promises).then(([encodeText, fontUrls]) => {\n      this.#fontManager.addFontSpade(encodeText)\n      this.#transfer = new Transfer(this.#recorder, this.#fontManager)\n      // 处理css @font-face\n      if (document.body) {\n        this.#fontManager.buildFontDeclareStyle(fontUrls[0]) // 只需要一个url即可\n      } else {\n        document.addEventListener('DOMContentLoaded', function() {\n          this.#fontManager.buildFontDeclareStyle(fontUrls[0]) // 只需要一个url即可\n        })\n      }\n      this.#loaded = true\n      console.log(`当前页面对应的水印编码为: ${this.#recorder.abbrGlyphCode}`)\n      // 资源加载成功但是水印编码上传失败此时使用本地编码\n      this.#recorder.record().catch((errType) => {\n        this.#transfer.update(true)\n      })\n    }).catch(err => {\n      console.log(err)\n      console.log('连接出错 at copy listener class')\n      this.#error = true\n      // 发送错误\n    })\n    // 注册默认timeout事件\n    this.on(EVENT_TIMEOUT, function(err, text) {\n      if (err) {\n        console.log('event timeout')\n        console.warn(err)\n        return text\n      }\n    })\n  }\n\n  get connectStatus() {\n    return this.#loaded\n  }\n\n  /**\n   * 请求获取字体文件\n   */\n  connect() {\n    // 先判断是否加载成功 如果未加载成功则开始加载\n    var timeStep = 50, waitTime = 0\n    if (this.#transfer && this.#loaded) {\n      // 无效等待直接连接成功\n      return Promise.resolve(this.#transfer)\n    } else {\n      return new Promise((resolve, reject) => {\n        var timer = setInterval(() => {\n          if (this.#transfer && this.#loaded) {\n            clearInterval(timer)\n            this._trigger(EVENT_CONNECTED, [null, this.#transfer])\n            resolve(this.#transfer) // 等待加载成功\n          } else {\n            waitTime += timeStep\n          }\n          if (this.#error) { // 发生错误\n            reject(EVENT_ERROR)\n            this._trigger(EVENT_ERROR)\n          } else if (waitTime >= this.#fontManager.manager.getTimeout()) { // 超时\n            this._trigger(EVENT_TIMEOUT)\n            reject(EVENT_TIMEOUT)\n          }\n        }, timeStep) // 每隔50ms判断\n      })\n    }\n  }\n\n  /**\n   * 添加css样式选择器\n   * @param {*} selector \n   * @param {*} fontName (声明自定义字体) (取值范围为固定的枚举值)\n   * @param {*} timeout \n   */\n  addRule(selector, fontName) {\n    // 保存domSelector\n    var oldLength = this.domSelector.size\n    this.domSelector.add(selector)\n    if (this.domSelector.size > oldLength) { // new Rule\n      // 判断fontNames是否存在fontName 如果存在表示无需再次创建字体规则\n      if (fontName && (this.#fontManager.getAllFontNames().indexOf(fontName) === -1)) { // 新的字体规则\n        return this.#fontManager.addFontDeclare(selector, fontName).then(() => {\n          console.log('触发EVENT_ADD_FONT_RULE事件')\n          this._trigger(EVENT_ADD_FONT_RULE, [null, fontName])\n          return Promise.resolve()\n        }).catch(eventName => {\n          this._trigger(eventName, eventName)\n          return Promise.reject(eventName)\n        })\n      } else {\n        // 给默认字体添加css选择器\n        this.#fontManager.addFontSelector(selector)\n        return Promise.resolve()\n      }\n    } else {\n      return Promise.reject('该选择器已经被添加过了')\n    }\n  }\n\n  transform(text) {\n    if (!DeviceDetect.isValidSystem() || DeviceDetect.isServerTransfer()) { // 返回原始内容\n      return text\n    } else {\n      if (this.#transfer && this.#loaded) {\n        return this.#transfer.transform(text)\n      } else {\n        return text\n      }\n    }\n  }\n\n  update(local) {\n    if (this.#transfer && this.#loaded) {\n      this.#transfer.update(local)\n    } else {\n      this._trigger(EVENT_TIMEOUT, '字体资源加载超时')\n    }\n  }\n\n  remove() {\n    this._trigger(EVENT_REMOVE)\n  }\n\n  /**\n   * binding event handler\n   * @param {*} eventName \n   * @param {*} callback \n   */\n  on(eventName, callback) {\n    if (!this.eventQueue[eventName]) {\n      this.eventQueue[eventName] = []\n    }\n    this.eventQueue[eventName].push(callback)\n  }\n\n  /**\n   * trigger event\n   * @param {*} eventName \n   * @param {*} eventParams \n   * @param {*} defaultHandler \n   */\n  _trigger(eventName, eventParams, defaultHandler) {\n    if (this.eventQueue[eventName] && this.eventQueue[eventName].length) {\n      for(let i = 0; i < this.eventQueue[eventName].length; i++) {\n        var handler = this.eventQueue[eventName][i]\n        if (typeof handler == 'function') {\n          if (typeof defaultHandler == 'function') {\n            if (Array.isArray(eventParams)) {\n              defaultHandler(...eventParams)\n            } else {\n              defaultHandler(eventParams)\n            }\n          }\n          if (Array.isArray(eventParams)) {\n            handler(...eventParams)\n          } else {\n            handler(eventParams)\n          }\n        }\n      }\n    }\n  }\n}\n\nmodule.exports = CopyListener","const config = require('../config/index')\n\n/**\n * \n */\nclass DeviceDetect {\n  static getSystem() {\n    if (DeviceDetect.isPCEnvironment()) {\n      return DeviceDetect.getPCSystem()\n    } else {\n      return DeviceDetect.getMobileSystem()\n    }\n  }\n\n  static isPCEnvironment() {\n    if(window.navigator && window.navigator.userAgent){\n      if(/(iPhone|iPad|iPod|iOS|Android)/i.exec(window.navigator.userAgent)){ // Mobile\n        return false\n      }else{ // PC\n        return true\n      }\n    }\n    return false\n  }\n\n  static getPCSystem() {\n    if(window.navigator && window.navigator.platform){\n      if(window.navigator.platform.toLowerCase().indexOf('win') > -1){\n        return 'windows'\n      }else if(window.navigator.platform.toLowerCase().indexOf('mac') > -1){\n        return 'mac'\n      }else{\n        return window.navigator.platform\n      }\n    }\n    return '' \n  }\n\n  static getMobileSystem () {\n    if(window.navigator && window.navigator.userAgent){\n      if(/(iPhone|iPad|iPod|iOS)/i.exec(window.navigator.userAgent)){\n        return 'ios'\n      }else if(window.navigator.userAgent.match(/Android/i)){\n        return 'Android'\n      }\n    }\n  }\n\n  static getDeviceInfo() {\n    var deviceInfo = {}\n    var os = DeviceDetect.getSystem()\n    if (DeviceDetect.isPCEnvironment()) { // pc\n      let { browser, version: browserVersion } = DeviceDetect.getPCBrowserInfo()\n      deviceInfo = Object.assign({}, {\n        isPC   : true,\n        os, // windows mac\n        isLowIE: browser == 'IE' && browserVersion <= 11,\n        browser,\n        browserVersion\n      })\n    } else { // mobile web\n      let { version: osVersion, networkType } = DeviceDetect.getMobileBrowserInfo()\n      deviceInfo = Object.assign({}, {\n        isPC: false,\n      }, {\n        os         : os || '', // Android IOS\n        osVersion  : osVersion || '',\n        networkType: networkType || ''\n      })\n    }\n    return deviceInfo\n  }\n\n  static getPCBrowserInfo() {\n    var data = {}\n    if(window.navigator && window.navigator.userAgent){\n      var userAgent = window.navigator.userAgent.toLowerCase()\n      var IERegExp = new RegExp(/MSIE\\s+(\\d+\\.\\d+)/i)\n      var EdgeRegExp = new RegExp(/Edge\\/(\\d+)/i)\n      if(userAgent.indexOf('compatible') > -1 && userAgent.indexOf('msie') > -1){\n        // IE11以下\n        data['version'] = parseInt(userAgent.match(IERegExp)[1])\n        data['browser'] = 'IE'\n      }else if(userAgent.indexOf('edge') > -1){\n        // Edge\n        data['version'] = parseInt(userAgent.match(EdgeRegExp)[1])\n        data['browser'] = 'Edge'\n      }else if(userAgent.indexOf('trident') > -1 && userAgent.indexOf('rv:11.0') > -1){\n        // IE11\n        data['version'] = 11\n        data['browser'] = 'IE'\n      }else if(userAgent.indexOf('firefox') > -1){\n        // FireFox\n        data['version'] = parseInt(userAgent.match(/firefox\\/(\\d+)/)[1])\n        data['browser'] = 'Firefox'\n      }else if(userAgent.indexOf('safari') > -1 && userAgent.indexOf('chrome') == -1){\n        // Safari\n        data['version'] = parseInt(userAgent.match(/version\\/(\\d+)/)[1])\n        data['browser'] = 'Safari'\n      }else if(userAgent.indexOf('safari') > -1 && userAgent.indexOf('chrome') > -1){\n        // Chrome\n        data['version'] = parseInt(userAgent.match(/chrome\\/(\\d+\\.?\\d+?)/)[1])\n        data['browser'] = 'Chrome'\n        for(let key in window.navigator.mimeTypes){\n          if(window.navigator.mimeTypes[key] && window.navigator.mimeTypes[key]['type'] == 'application/vnd/chromium.remoting-viewer'){\n            // 360\n            data['browser'] = '360'\n            data['version'] = null\n          }\n        }\n      }else{\n        data['browser'] = 'Other'\n        data['version'] = null\n      }\n    }\n    return data\n  }\n\n  static getMobileBrowserInfo() {\n    var data = {}\n    if(window.navigator && window.navigator.userAgent){\n      if(/(iPhone|iPad|iPod|iOS)/i.exec(window.navigator.userAgent)){\n        let version = window.navigator.userAgent.match(/OS\\s+(\\d+_\\d+(_\\d+)?)/i)[1]\n        if(version){\n          version = version.replace('_', '.')\n        }\n        data['version'] = version\n      }else if(window.navigator.userAgent.match(/Android/i)){\n        data['version'] = window.navigator.userAgent.match(/Android\\s+(\\d+(\\.\\d+)?)?/)[1] || ''\n      }\n    }\n  \n    if(window.navigator && window.navigator.connection && window.navigator.connection.effectiveType){\n      data['networkType'] = window.navigator.connection.effectiveType\n    }\n    return data\n  }\n\n  static isValidSystem() {\n    return config.VALID_SYSTEM.indexOf(DeviceDetect.getSystem().toUpperCase()) !== -1\n  }\n\n  static isServerTransfer() {\n    return config.IS_SERVER_TRANSFER\n  }\n}\n\nmodule.exports = DeviceDetect\n","const config = require('../config/index')\nconst { EVENT_TIMEOUT, EVENT_ERROR } = require('../data/events')\nconst { HTMLTAGS } = require('../data/index')\n\n/**\n * 字体管理模块\n */\nclass FontManager {\n  /**\n   * @param {OptionsManager} manager 配置管理器\n   */\n  constructor(manager) {\n    this.manager = manager\n    var fontName = this.manager.getSystemFontName()\n    this.fontSets = [\n      {\n        fontName,\n        fontUrl: config.FONT_BASE_URL + fontName,\n        loaded: false\n      }\n    ]\n  }\n\n  addFontSet(fontName) {\n    this.fontSets.push({\n      fontName,\n      fontUrl: config.FONT_BASE_URL + fontName,\n      loaded: false\n    })\n  }\n\n  /**\n   * 加载字形符号Unicode编码文件\n   */\n  loadSpadeFile() {\n    return new Promise((resolve, reject) => {\n      var xhr = new XMLHttpRequest()\n      xhr.timeout = this.manager.getTimeout()\n      xhr.open('GET', config.SPADES_URL, true)\n      xhr.setRequestHeader('Content-Type', 'text/plain')\n      xhr.onreadystatechange = function (){\n        if(xhr.readyState === XMLHttpRequest.DONE){\n          if(xhr.status === 200 || xhr.status == 304){\n            resolve(xhr.responseText)\n            // 在这里添加字形文件\n            console.log('loadSpadeFile success')\n          }else{\n            console.log('loadSpadeFile error')\n            reject(EVENT_ERROR)\n          }\n        }\n      }\n      xhr.ontimeout = function() {\n        console.log('loadSpadeFile ontimeout')\n        reject(EVENT_TIMEOUT)\n      }\n      xhr.onerror = function() {\n        console.log('loadSpadeFile onerror')\n        reject(EVENT_ERROR)\n      }\n      xhr.send()\n    })\n  }\n\n  /**\n   * 加载某种字体的全部格式文件\n   */\n  loadAllFontFile() {\n    // 通过fontSets找到最后一个未加载的字体文件\n    var index = this.fontSets.findIndex((font) => {\n      return !font.loaded\n    })\n    var fontUrl = this.fontSets[index]['fontUrl']\n    try {\n      if (document.fonts && (typeof FontFace == 'function')) { // 支持FontFace\n        var fontPromises = config.FONT_TYPES.map(fontType => {\n          return new FontFace('pre_longhu_default_font', `url(${fontUrl}.${fontType})`).load()\n        })\n        return Promise.all(fontPromises).then(() => {\n          return Promise.resolve([fontUrl])\n        }).catch(() => {\n          return Promise.reject(EVENT_ERROR)\n        })\n      } else {\n        // 常规get请求字体资源文件\n        var promises = config.FONT_TYPES.map(fontType => {\n          return this.loadFontFile(fontUrl, fontType)\n        })\n        return Promise.all(promises).then((data) => {\n          console.log('加载所有fontfile success')\n          return Promise.resolve(data)\n        }).catch((eventName) => {\n          console.log('加载出错 at fontManager loadAllFontFile')\n          return Promise.reject(eventName)\n        })\n      }\n    } catch (error) {\n      console.log('捕获错误 at fontManager loadAllFontFile')\n      return Promise.reject(EVENT_ERROR)\n    }\n  }\n\n  /**\n   * 加载单个字体的单个格式文件\n   * @param {*} fontUrl \n   * @param {*} fontType \n   */\n  loadFontFile(fontUrl, fontType) {\n    return new Promise((resolve, reject) => {\n      var xhr = new XMLHttpRequest()\n      xhr.timeout = this.manager.getTimeout()\n      xhr.open('GET', fontUrl + '.' + fontType, true)\n      xhr.onreadystatechange = function (){\n        if(xhr.readyState === XMLHttpRequest.DONE){\n          if(xhr.status === 200 || xhr.status == 304){\n            console.log('success')\n            resolve(fontUrl)\n          }else{\n            console.log('onerror')\n            reject(EVENT_ERROR)\n          }\n        }\n      }\n      xhr.ontimeout = function() {\n        console.log('ontimeout')\n        reject(EVENT_TIMEOUT)\n      }\n      xhr.onerror = function() {\n        console.log('onerror')\n        reject(EVENT_ERROR)\n      }\n      xhr.send()\n    })\n  }\n\n  /**\n   * 解码字形unicode文件\n   */\n  addFontSpade(spades) {\n    this.spades = JSON.parse(spades).map(function(charCode) {\n      return String.fromCharCode(charCode)\n    })\n    console.log(this.spades)\n    console.log('this.spades')\n  }\n\n  buildFontDeclareStyle(fontUrl, fontName) {\n    // 根据支持的文件格式生成css\n    var style = document.createElement('style')\n    style.id = 'maia-copy-style'\n    let fontFormat = '', fontFamilySrc = ''\n    if (config.FONT_TYPES.indexOf('eot') !== -1) {\n      fontFamilySrc = `src: url('${fontUrl}.eot');\\nsrc: url('${fontUrl}.eot?#iefix') format('embedded-opentype'),\\n`\n    } else {\n      fontFamilySrc = 'src: ' \n    }\n    config.FONT_TYPES.forEach(fontType => {\n      if (fontType == 'eot') {\n        fontFamilySrc += ''\n      } else {\n        fontFormat = fontType === 'ttf' ? 'truetype' : fontType \n        fontFamilySrc += `url('${fontUrl}.${fontType}') format('${fontFormat}'),\\n`\n      }\n    })\n    fontFamilySrc = fontFamilySrc.replace(/\\,\\n$/, ';')\n    var fontDeclare = `@font-face { font-family: 'longhu-default-font'; ${fontFamilySrc}}`\n    var oldFontFamily = getComputedStyle(document.body).fontFamily\n    var newFontFamily = '\"longhu-default-font\", ' + oldFontFamily\n    // 罗列所有html标签\n    style.innerHTML = fontDeclare + `\\n ${HTMLTAGS} {font-family: ${newFontFamily};}`\n    document.head.appendChild(style)\n  }\n\n  /**\n   * 添加新的字体规则及css选择器\n   * @param {*} ruleName \n   * @param {*} fontName \n   */\n  addFontDeclare(ruleName, fontName) {\n    // 根据支持的文件格式生成css\n    let styleTAG = document.getElementById('maia_copy_custom_style')\n    let oldStyleRules = ''\n    if (styleTAG) {\n      oldStyleRules = styleTAG.textContent\n      document.head.removeChild(styleTAG)\n    }\n    var fontUrl = config.FONT_BASE_URL + fontName\n    var promises = config.FONT_TYPES.map(fontType => {\n      return this.loadFontFile(fontUrl, fontType)\n    })\n    return Promise.all(promises).then(() => {\n      // 记录fontName\n      this.fontSets.push({\n        fontName,\n        fontUrl: config.FONT_BASE_URL + fontName,\n        loaded: true\n      })\n      let fontFormat = '', fontFamilySrc = ''\n      if (config.FONT_TYPES.indexOf('eot') !== -1) {\n        fontFamilySrc = `src: url('${fontUrl}.eot');\\nsrc: url('${fontUrl}.eot?#iefix') format('embedded-opentype'),\\n`\n      } else {\n        fontFamilySrc = 'src: ' \n      }\n      config.FONT_TYPES.forEach(fontType => {\n        if (fontType == 'eot') {\n          fontFamilySrc += ''\n        } else {\n          fontFormat = fontType === 'ttf' ? 'truetype' : fontType \n          fontFamilySrc += `url('${fontUrl}.${fontType}') format('${fontFormat}'),\\n`\n        }\n      })\n      fontFamilySrc = fontFamilySrc.replace(/\\,\\n$/, ';')\n      var fontDeclare = `@font-face { font-family: 'longhu-custom-${fontName}'; ${fontFamilySrc}}`\n      var oldFontFamily = getComputedStyle(document.body).fontFamily\n      var newFontFamily = `\"longhu-custom-${fontName}\", ${oldFontFamily}`\n      var styleRules = oldStyleRules + '\\n' + fontDeclare + `\\n ${ruleName} {font-family: ${newFontFamily};}`\n      styleTAG = document.createElement('style')\n      styleTAG.id = 'maia_copy_custom_style'\n      styleTAG.textContent = styleRules\n      document.head.appendChild(styleTAG)\n      return Promise.resolve()\n    }).catch((err) => {\n      return Promise.reject(err)\n    })\n  }\n\n  addFontSelector(ruleName) {\n    let styleTAG = document.getElementById('maia_copy_custom_style')\n    let oldFontFamily = getComputedStyle(document.body).fontFamily\n    let newFontFamily = '\"longhu-default-font\", ' + oldFontFamily\n    let oldStyleRules = ''\n    if (styleTAG) {\n      oldStyleRules = styleTAG.textContent\n      document.head.removeChild(styleTAG)\n    }\n    let styleRules = oldStyleRules + `\\n\n      ${ruleName} {\n        font-family: ${newFontFamily};\n      }\n    `\n    styleTAG = document.createElement('style')\n    styleTAG.id = 'maia_copy_custom_style'\n    styleTAG.textContent = styleRules\n    document.head.appendChild(styleTAG)\n  }\n\n  getAllFontNames() {\n    var fontNames = []\n    this.fontSets.forEach((font) => {\n      if (font.loaded) {\n        fontNames.push(font.fontName)\n      }\n    })\n    return fontNames\n  }\n}\n\nmodule.exports = FontManager","/**\n * 用于记录并上报相关数据的模块\n * 1. 记录oaCount, appKey, deviceInfo, appInfo, glyphCode, abbrGlyphCode\n * 2. 具有生成和更新水印编码数据功能\n * 2. 具有上报数据及错误(正常的水印数据、资源加载异常、运营统计数据等)功能\n */\n\nconst md5 = require('md5')\nconst config = require('../config/index')\nconst DeviceDetect = require('./deviceDetect')\nconst { \n  STORAGE_ITEM_KEY,\n  STORAGE_PREFIX,\n  STORAGE_CHAR_COUNT,\n  STORAGE_TRANS_COUNT\n} = require('../data/index')\nconst {EVENT_SUCCESS, EVENT_ERROR, EVENT_TIMEOUT} = require('../data/events')\nclass Recorder {\n  #mode\n  constructor(oaCount, appKey) {\n    this.oaCount = oaCount // oa账号\n    this.appKey = appKey // 应用key\n    this.glyphCode = null // 完整的32位字符串\n    this.abbrGlyphCode = null // 字体水印编码(简写22位字符串)\n    this.#mode = '' // 模式\n    this.devCustomGlyphCode = null // 调试模式下自定义的水印编码\n    this.lastCreatedTime = null // 水印编码生成的时间\n  }\n\n  /**\n   * 生成水印编码(md5算法32位字符串截取前10位字符)\n   * 不再使用deviceKey而是使用time及oaCount及appKey计算md5\n   * 水印编码格式: 10位字符(16进制)转换为20位字符(4进制不足两位补0)\n   * 在页面文字编码时,在水印编码前后各添加3作为默认分隔符使得水印编码长度达到22位\n   * 该方法返回: md5字符串(上报数据), 页面文字水印编码(22位字符), 水印编码生成时间(时间戳)\n   * @returns Array(md5Code: string, abbrGlyphCode: string, createdTime: Number)\n   */\n  generateGlyphCode() {\n    if (this.#mode === 'custom') {\n      this.lastCreatedTime = Date.now()\n      this.generateCustomGlyphCode(this.devCustomGlyphCode)\n    } else {\n      this.lastCreatedTime = Date.now()\n      var source = '' + this.lastCreatedTime + this.oaCount + this.appKey\n      this.glyphCode = md5(source)\n      var abbrcode = this.glyphCode.slice(0, config.CODELEN).split('').map((unit) => {\n        var codeStr = Number('0x' + unit).toString(config.CODE_BASE)\n        if (codeStr.length < Math.sqrt(config.CODE_BASE)) {\n          codeStr = '0' + codeStr\n        }\n        return codeStr\n      }).join('')\n      this.abbrGlyphCode = '3' + abbrcode + '3'\n    }\n    return this.abbrGlyphCode\n  }\n\n  /**\n   * 当水印服务器网络出现异常时,使用oaCount与time生成本地水印编码\n   * 方便解码出oaCount与time(时/分)\n   */\n  generateLocalGlyphCode() {\n    var oaCount = this.oaCount\n    if (this.oaCount.length > 5) { // oaCount(前4位)+ 数字1位\n      oaCount = this.oaCount.slice(0, 4) + this.oaCount.slice(this.oaCount.length - 1)\n    }\n    var now = new Date()\n    var month = (now.getMonth() + 1) < 10 ? '0' + (now.getMonth() + 1): now.getMonth() + 1\n    var day = now.getDate() < 10 ? '0' + now.getDate() : now.getDate()\n    var time = '' + month + '' + day\n    this.abbrGlyphCode = '' + oaCount + '3' + time\n    this.glyphCode = '' + oaCount + '3' + time\n    console.log(`生成本地编码 = ${this.abbrGlyphCode}`)\n    return this.abbrGlyphCode\n  }\n\n  /**\n   * 代码调试时允许指定水印编码\n   * @param {*} customCode \n   */\n  generateCustomGlyphCode(customCode) {\n    if (typeof customCode !== 'string') return null\n    var code = customCode.split('').slice(0, 16).map((unit) => {\n      var num = Number('0x' + unit)\n      if (num >= 16) return ''\n      var code = num.toString(config.CODE_BASE)\n      if (code.length < Math.sqrt(config.CODE_BASE)) {\n        code = '0' + code\n      }\n      return code\n    }).join('')\n    this.abbrGlyphCode = code\n    this.glyphCode = customCode\n  }\n\n  /**\n   * 记录水印数据\n   */\n  record() {\n    // 上报\n    console.log(`oaCount = ${this.oaCount}`)\n    console.log(`appKey = ${this.appKey}`)\n    console.log(`lastCreatedTime = ${this.lastCreatedTime}`)\n    console.log(`glyphCode = ${this.glyphCode}`)\n    let deviceInfo = DeviceDetect.getDeviceInfo()\n    if(deviceInfo['browser'] == 'IE' && deviceInfo['browserVersion'] <= 9){\n      return\n    }\n    let data = {\n      'version' : config.VERSION,\n      'platform': 'H5',    // 暂时修改成H5，等后端增加类型，修改成H5-font\n      'appKey'  : this.appKey,\n      'wmList'  : [] \n    }\n    let prevWMData = []\n    if(window.localStorage){\n      for(let i = 0; i < window.localStorage.length; i++){\n        let itemKey = window.localStorage.key(i)\n        if((itemKey.indexOf('count') === -1) && (itemKey.indexOf(STORAGE_PREFIX) == 0)){ // 找到未上传成功的数据\n          console.log('找到未上传成功的数据')\n          prevWMData = prevWMData.concat(JSON.parse(window.localStorage.getItem(itemKey)))\n        }\n      }\n    }\n    data['wmList'] = prevWMData\n    let wmItem = {\n      wmKey      : this.glyphCode,\n      userAccount: this.oaCount,\n      markTime   : this.lastCreatedTime,\n      os         : deviceInfo['os'],\n      osVersion  : deviceInfo['browserVersion'] || deviceInfo['osVersion'],\n      browser    : deviceInfo['browser'],\n      extendValue: JSON.stringify({\n        '_page_title_': document.title || '',\n        '_page_url_'  : document.location.href || ''\n      })\n    }\n    data['wmList'].push(wmItem)\n    return new Promise((resolve, reject) => {\n      let xhr = new XMLHttpRequest()\n      xhr.open('POST', config.GATHER_SERVER_URL, true)\n      xhr.setRequestHeader('X-Gaia-Api-Key', config.API_KEY)\n      xhr.setRequestHeader('Content-Type', 'application/json')\n      xhr.timeout = config.TIMEOUT // 5s\n      xhr.onreadystatechange = () => {\n        if(xhr.readyState === XMLHttpRequest.DONE){\n          if(xhr.status === 200){\n            let res\n            if(xhr.response){\n              res = JSON.parse(xhr.response)\n            }else if(xhr.responseText){\n              res = JSON.parse(xhr.responseText)\n            }\n            if(res && res.code == 0){\n              this.clearWaterMarkStorage(data)\n              resolve(EVENT_SUCCESS)\n            }else{\n              this.saveWaterMarkStorage(data)\n              reject(EVENT_ERROR)\n            }\n          }else{\n            this.saveWaterMarkStorage(data)\n            reject(EVENT_ERROR)\n          }\n        }\n      }\n      xhr.ontimeout = () => {\n        this.saveWaterMarkStorage(data)\n        reject(EVENT_TIMEOUT)\n      }\n      xhr.onerror = () => {\n        this.saveWaterMarkStorage(data)\n        reject(EVENT_ERROR)\n      }\n      xhr.send(JSON.stringify(data))\n    })\n  }\n\n  /**\n   * 记录水印错误\n   * @param {*} errType \n   */\n  recordError(errType) {\n    var data = {\n      errType\n    }\n    return new Promise((resolve, reject) => {\n      let xhr = new XMLHttpRequest()\n      xhr.open('POST', config.ERROR_GATHER_SERVER_URL, true)\n      xhr.setRequestHeader('X-Gaia-Api-Key', config.ERROR_API_KEY)\n      xhr.setRequestHeader('Content-Type', 'application/json')\n      xhr.timeout = config.TIMEOUT // 5s\n      xhr.onreadystatechange = function (){\n        if(xhr.readyState === XMLHttpRequest.DONE){\n          if(xhr.status === 200){\n            let res\n            if(xhr.response){\n              res = JSON.parse(xhr.response)\n            }else if(xhr.responseText){\n              res = JSON.parse(xhr.responseText)\n            }\n            if(res && res.code == 0){\n              resolve(EVENT_SUCCESS)\n            }else{\n              reject(EVENT_ERROR)\n            }\n          }else{\n            reject(EVENT_ERROR)\n          }\n        }\n      }\n      xhr.ontimeout = function() {\n        reject(EVENT_TIMEOUT)\n      }\n      xhr.onerror = function() {\n        reject(EVENT_ERROR)\n      }\n      xhr.send(JSON.stringify(data))\n    })\n  }\n\n  /**\n   * 记录汉字转换率\n   * @param {*} transCount 转换汉字个数\n   * @param {*} charCount 总汉字个数\n   */\n  recordGlyphCount(transCount, charCount) {\n    // 上报转换的文字个数, 从localstorage中取出\n    let oldCharCount = window.localStorage.getItem(STORAGE_CHAR_COUNT)\n    let oldTransCount = window.localStorage.getItem(STORAGE_TRANS_COUNT)\n    if (oldTransCount && !Number.isNaN(Number(oldTransCount))) {\n      transCount = Number(oldTransCount) + Number(transCount)\n    } else if (!Number.isNaN(Number(transCount))) {\n      transCount = Number(transCount)\n    } else {\n      transCount = 0\n    }\n    if (oldCharCount && !Number.isNaN(Number(oldCharCount))) {\n      charCount = Number(oldCharCount) + Number(charCount)\n    } else if (!Number.isNaN(Number(charCount))) {\n      charCount = Number(charCount)\n    } else {\n      charCount = 0\n    }\n    if (transCount >= config.CHUNKCOUNT) {\n      console.log('进行字数上报')\n      transCount = 0\n      charCount = 0\n    } else {\n      window.localStorage.setItem(STORAGE_TRANS_COUNT, transCount)\n      window.localStorage.setItem(STORAGE_CHAR_COUNT, charCount)\n    }\n  }\n\n  setMode(mode, customGlyphCode) {\n    this.#mode = mode\n    this.devCustomGlyphCode = customGlyphCode\n  }\n\n  /**\n   * 存储水印数据信息\n   * @param {*} data \n   */\n  saveWaterMarkStorage (data){\n    // for(let i = 0; i < data['wmList'].length; i++){\n    if(window.localStorage){\n      // 针对addRule(fontName)可能存在多次覆盖,但不影响功能\n      window.localStorage.setItem(STORAGE_ITEM_KEY, JSON.stringify(data['wmList']))\n    }\n    // }\n  }\n\n  /**\n   * 清空所有的水印编码数据\n   * @param {*} data \n   */\n  clearWaterMarkStorage (data){\n    // for(let i = 0; i < data['wmList'].length; i++){\n    if(window.localStorage){\n      window.localStorage.removeItem(STORAGE_ITEM_KEY)\n    }\n    // }\n  }\n}\n\nmodule.exports = Recorder","const Utils = require('../utils/index.js')\nconst config = require('../config/index')\nconst DeviceDetect = require('./deviceDetect.js')\nclass Transfer {\n  #recorder\n  #fontManager\n  #spades\n  #glyphCode\n  #pointer = 0\n  /**\n   * \n   * @param {*} recorder Recorder\n   * @param {*} fontManager FontManager\n   */\n  constructor(recorder, fontManager) {\n    this.#recorder = recorder\n    this.#fontManager = fontManager\n    this.#glyphCode = this.#recorder.generateGlyphCode()\n    this.#spades = this.#fontManager.spades\n  }\n\n  /**\n   * 将文本转换为unicode\n   * @param {*} text \n   */\n  transform(text) {\n    // 未开启水印的操作系统/后端编码 直接返回原始内容\n    if (!DeviceDetect.isValidSystem() || DeviceDetect.isServerTransfer()) {\n      return text\n    }\n    var transCount = 0, charCount = 0, processText = '', textObj = [], execRes, splitHtml, splitIndex, presplitIndex = 0\n    const cjkCharReg = new RegExp('[\\\\u4E00-\\\\u9FFF]', 'i')\n    // 先判断text是否含有html标签\n    var r = /<\\/?.+?\\/?>/g\n    if (/<\\/?.+?\\/?>/g.test(text)) {\n      while(execRes = r.exec(text)) {\n        // 只要匹配到html标签则进行分割将第一项存入,后面接着分割\n        var splitHtml = execRes[0]\n        var splitIndex = execRes.index\n        var part = text.slice(presplitIndex, splitIndex)\n        presplitIndex = splitIndex + splitHtml.length\n        textObj.push({\n          text: part,\n          transform: true\n        })\n        textObj.push({\n          text: splitHtml,\n          transform: false\n        })\n      }\n      // 补齐最后一项\n      textObj.push({\n        text: text.slice(presplitIndex),\n        transform: true\n      })\n    } else {\n      textObj.push({\n        text,\n        transform: true\n      })\n    }\n    var char, glyphIndex, charUnicode\n    for(let j = 0; j < textObj.length; j++) {\n      if (textObj[j].transform) {\n        for(let i = 0; i < textObj[j].text.length; i++) {\n          char = textObj[j].text[i]\n          glyphIndex = 0\n          charUnicode = Number(char.charCodeAt(0)).toString(16)\n          if (!cjkCharReg.test(char)) {\n            // 只转换unicode范围为/\\u4E00-\\u9FFF/的字符集\n            processText += ('&#x' + charUnicode)\n            continue\n          }\n          if (this.#spades.indexOf(char) !== -1) { // 字符存在\n            glyphIndex = Number(this.#glyphCode[this.#pointer])\n            // 指针长度为待转换文本的长度->转换->code编码长度\n            this.#pointer = (this.#pointer + 1) % this.#glyphCode.length\n            processText += ('&#x' + charUnicode + glyphIndex)\n            transCount++ // 已经转换的汉字个数\n          } else { // 字符不存在\n            processText += ('&#x' + charUnicode)\n          }\n          charCount++ // 待转换的文本中的汉字个数\n        }\n      } else {\n        // html标签\n        processText += textObj[j].text\n      }\n    }\n    this.#recorder.recordGlyphCount(transCount, charCount) // 记录使用的总汉字个数与转换汉字个数\n    return processText\n  }\n\n  update(local) {\n    this.#glyphCode = local ? this.#recorder.generateLocalGlyphCode() : this.#recorder.generateGlyphCode()\n    this.#pointer = 0 // 重置指针\n    if (!local) {\n      this.#recorder.record().catch((errType) => {\n        if (config.IS_OPEN_NON_NETWORK) { // 使用本地编码\n          this.#glyphCode = this.#recorder.generateLocalGlyphCode()\n          console.log(`no network, glyphCode = ${this.#glyphCode}`)\n        }\n        // 上报错误\n        console.log(errType)\n        this.#recorder.recordError(errType).catch(() => {\n  \n        })\n      })\n    }\n  }\n}\n\nmodule.exports = Transfer","/**\n * EventName Set\n */\nmodule.exports = {\n  EVENT_ADD_FONT_RULE: 'addFontRule',\n  EVENT_REMOVE: 'remove',\n  EVENT_TIMEOUT: 'timeout',\n  EVENT_ERROR: 'error',\n  EVENT_SUCCESS: 'success',\n  EVENT_CONNECTED: 'connected'\n}","/**\n * FontName Set\n */\nmodule.exports = {\n  MICROSOFTYAHEI: 'MicrosoftYahei',\n  PINGFANGSC: 'PingfangSC'\n}\n","const HTMLTAGS = [\n  'body', '.maia_default_copy_listener'\n].join(',')\nconst STORAGE_PREFIX = 'maia_copy_listener_'\nconst STORAGE_ITEM_KEY = 'maia_copy_listener_item'\nconst STORAGE_CHAR_COUNT = 'maia_copy_listener_char_count'\nconst STORAGE_TRANS_COUNT = 'maia_copy_listener_trans_count'\n\nmodule.exports = {\n  HTMLTAGS,\n  STORAGE_PREFIX,\n  STORAGE_ITEM_KEY,\n  STORAGE_CHAR_COUNT,\n  STORAGE_TRANS_COUNT\n}","const config = require('./config')\nconst CopyListener = require('./core/copyListener')\nconst Utils = require('./utils/index')\nconst Recorder = require('./core/recorder')\nconst { EVENT_ADD_FONT_RULE, EVENT_REMOVE } = require('./data/events')\nconst FontManager = require('./core/fontManager')\nconst OptionsManager = require('./config/option')\n\n/**\n * options:\n * {\n *    fontName: 全部操作系统默认字体(MicrosoftYahei) // 其实没有默认值\n *    winFontName: windows(MicrosoftYahei)\n *    macFontName: mac(PingfangSC)\n *    androidFontName: android(MicrosoftYahei)\n *    iosFontName: ios(PingfangSC)\n *    timeout: 超时时间\n * 不建议开放的配置\n *    system: 指定开启水印编码的操作系统(window/mac/android/ios)\n * }\n */\nconst createCopyListener = (function(){\n  var listener\n  function createCopyListener(oaCount, appKey, options) {\n    if(listener) {\n      console.warn('不能多次创建实例')\n      return listener\n    }\n    // 创建recorder, optionsManager, fontManager, listener\n    const recorder = new Recorder(oaCount, appKey)\n    if (options['customCode']) {\n      recorder.setMode('custom', options['customCode'])\n    }\n    const optionsManager = new OptionsManager(options)\n    const fontManager = new FontManager(optionsManager)\n    listener = new CopyListener(recorder, fontManager)\n\n    listener.on(EVENT_ADD_FONT_RULE, function(err, newFontName) {\n      if (!err) {\n        console.log(`当前加载的新字体: ${newFontName} 没有错误`)\n        // recorder.record().catch(() => {\n        //   // listener.update(true)\n        // })\n      }\n    })\n\n    listener.on(EVENT_REMOVE, function() {\n      listener = null\n    })\n    return listener\n  }\n  return createCopyListener\n})()\n\nmodule.exports = createCopyListener\n","const Utils = {\n  isObject(obj) {\n    return Object.prototype.toString.call(obj) === '[object Object]'\n  },\n  isNotEmptyString(str) {\n    return typeof str === 'string' && str !== ''\n  },\n  isNotString(str) {\n    return typeof str !== 'string'\n  },\n  isNotNaNNumber(num) {\n    return typeof num !== 'number' && Number.isNaN(num)\n  }\n}\n\nmodule.exports = Utils"],"sourceRoot":""}